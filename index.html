<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ú–µ–Ω—é —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #ffecd2, #fcb69f);
      color: #333;
    }
    h1 {
      text-align: center;
      padding: 30px;
      font-size: 36px;
      color: #222;
    }
    .menu {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 25px;
      max-width: 1400px;
      margin: auto;
      padding: 20px;
    }
    @media (max-width: 1200px) {
      .menu { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .menu { grid-template-columns: 1fr; }
    }
    .card {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      padding: 25px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    .card h2 {
      font-size: 22px;
      margin-bottom: 15px;
      color: #ff6600;
      border-bottom: 2px solid #ffe0cc;
      padding-bottom: 8px;
      text-align: center;
    }
    .card ul {
      list-style: none;
      padding: 0;
      margin: 0 0 15px 0;
    }
    .card ul li {
      padding: 10px;
      border-bottom: 1px solid #f2f2f2;
      font-size: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }
    .card ul li:hover { background: #fff6f0; }
    .dish-info {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .dish-info img {
      width: 35px;
      height: 35px;
      object-fit: cover;
      border-radius: 6px;
    }
    .btn {
      background: #ff6600;
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s ease;
      margin-top: 5px;
    }
    .btn:hover { background: #e05500; }
    .delete-btn {
      background: none;
      border: none;
      color: #cc0000;
      font-size: 18px;
      cursor: pointer;
      padding: 0 5px;
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    .card ul li:hover .delete-btn { opacity: 1; }

    /* —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ü–µ–ø—Ç–∞ */
    #recipePage {
      display: none;
      max-width: 800px;
      margin: 40px auto;
      padding: 30px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    #recipePage h2 { margin-bottom: 15px; color: #ff6600; }
    #recipeImage {
      max-width: 100%;
      border-radius: 15px;
      margin-bottom: 20px;
      display: none;
    }
    #recipeText {
      font-size: 18px;
      line-height: 1.6;
      margin-bottom: 20px;
    }
    #recipeEditor {
      display: none;
      flex-direction: column;
      gap: 10px;
    }
    #recipeEditor textarea {
      width: 100%;
      height: 150px;
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #ccc;
      resize: vertical;
    }
    #backBtn { margin-top: 20px; background: #555; }
    #backBtn:hover { background: #333; }

    /* –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
    #dishModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #dishModal .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      max-width: 90%;
      width: 300px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }
    #dishModal input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1 id="pageTitle">–ú–µ–Ω—é</h1>

  <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
  <div id="menuPage" class="menu">
    <div class="card">
      <h2>ü•ê –ó–∞–≤—Ç—Ä–∞–∫–∏</h2>
      <ul id="breakfast"></ul>
      <button class="btn" onclick="addDish('breakfast')">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
    </div>
    <div class="card">
      <h2>üç≤ –ì–æ—Ä—è—á–µ–µ</h2>
      <ul id="hot"></ul>
      <button class="btn" onclick="addDish('hot')">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
    </div>
    <div class="card">
      <h2>ü•ß –í—ã–ø–µ—á–∫–∞</h2>
      <ul id="bakery"></ul>
      <button class="btn" onclick="addDish('bakery')">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
    </div>
    <div class="card">
      <h2>ü•ó –°–∞–ª–∞—Ç—ã</h2>
      <ul id="salads"></ul>
      <button class="btn" onclick="addDish('salads')">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
    </div>
  </div>

  <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ—Ü–µ–ø—Ç–∞ -->
  <div id="recipePage">
    <h2 id="recipeTitle"></h2>
    <img id="recipeImage" alt="–§–æ—Ç–æ –±–ª—é–¥–∞">
    <p id="recipeText"></p>

    <!-- —Ä–µ–¥–∞–∫—Ç–æ—Ä -->
    <div id="recipeEditor">
      <textarea id="recipeInput"></textarea>
      <button class="btn" onclick="saveRecipe()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</button>
      <input type="file" id="imageInput" accept="image/*">
      <button class="btn" onclick="saveImage()">üì∏ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É</button>
    </div>

    <button class="btn" id="editBtn" onclick="editRecipe()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç</button>
    <br>
    <button class="btn" id="backBtn" onclick="showMenu()">‚¨Ö –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é</button>
  </div>

  <!-- –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥–∞ -->
  <div id="dishModal">
    <div class="modal-content">
      <h3>–ù–æ–≤–æ–µ –±–ª—é–¥–æ</h3>
      <input type="text" id="newDishName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
      <button class="btn" onclick="saveNewDish()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <button class="btn" style="background:#555;" onclick="closeDishModal()">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>

  <script>
    const defaultMenu = {
      breakfast: [
        { name: "–û–º–ª–µ—Ç —Å –æ–≤–æ—â–∞–º–∏", recipe: "–í–∑–±–µ–π—Ç–µ —è–π—Ü–∞, –¥–æ–±–∞–≤—å—Ç–µ –æ–≤–æ—â–∏, –æ–±–∂–∞—Ä—å—Ç–µ –Ω–∞ —Å–∫–æ–≤–æ—Ä–æ–¥–µ.", image: "" },
        { name: "–°—ã—Ä–Ω–∏–∫–∏ —Å–æ —Å–º–µ—Ç–∞–Ω–æ–π", recipe: "–¢–≤–æ—Ä–æ–≥ + —è–π—Ü–æ + –º—É–∫–∞. –°–ª–µ–ø–∏—Ç—å —Å—ã—Ä–Ω–∏–∫–∏, –æ–±–∂–∞—Ä–∏—Ç—å, –ø–æ–¥–∞—Ç—å —Å–æ —Å–º–µ—Ç–∞–Ω–æ–π.", image: "" },
        { name: "–ö–∞—à–∞ –æ–≤—Å—è–Ω–∞—è —Å —Ñ—Ä—É–∫—Ç–∞–º–∏", recipe: "–°–≤–∞—Ä–∏—Ç—å –æ–≤—Å—è–Ω–∫—É –Ω–∞ –º–æ–ª–æ–∫–µ, –¥–æ–±–∞–≤–∏—Ç—å —è–±–ª–æ–∫–∏, –±–∞–Ω–∞–Ω—ã –∏–ª–∏ —è–≥–æ–¥—ã.", image: "" }
      ],
      hot: [
        { name: "–ë–æ—Ä—â —É–∫—Ä–∞–∏–Ω—Å–∫–∏–π", recipe: "–°–≤–µ–∫–ª–∞, –∫–∞–ø—É—Å—Ç–∞, –∫–∞—Ä—Ç–æ—à–∫–∞, –º–æ—Ä–∫–æ–≤—å, –ª—É–∫, –º—è—Å–æ. –í–∞—Ä–∏—Ç—å 1 —á–∞—Å.", image: "" },
        { name: "–ü–∞—Å—Ç–∞ –∫–∞—Ä–±–æ–Ω–∞—Ä–∞", recipe: "–ü–∞—Å—Ç–∞ + –±–µ–∫–æ–Ω + —è–π—Ü–æ + —Å—ã—Ä –ø–∞—Ä–º–µ–∑–∞–Ω. –í—Å—ë –ø–µ—Ä–µ–º–µ—à–∞—Ç—å.", image: "" },
        { name: "–ö—É—Ä–∏—Ü–∞ —Å –∫–∞—Ä—Ç–æ—Ñ–µ–ª–µ–º", recipe: "–ó–∞–ø–µ—á—å –∫—É—Ä–∏—Ü—É —Å –∫–∞—Ä—Ç–æ—à–∫–æ–π –∏ —Å–ø–µ—Ü–∏—è–º–∏ –≤ –¥—É—Ö–æ–≤–∫–µ.", image: "" }
      ],
      bakery: [
        { name: "–ö—Ä—É–∞—Å—Å–∞–Ω", recipe: "–°–ª–æ—ë–Ω–æ–µ —Ç–µ—Å—Ç–æ, –º–∞—Å–ª–æ. –°–≤–µ—Ä–Ω—É—Ç—å –∏ –≤—ã–ø–µ–∫–∞—Ç—å –¥–æ –∑–æ–ª–æ—Ç–∏—Å—Ç–æ–π –∫–æ—Ä–æ—á–∫–∏.", image: "" },
        { name: "–ü–∏—Ä–æ–∂–∫–∏ —Å –∫–∞–ø—É—Å—Ç–æ–π", recipe: "–¢–µ—Å—Ç–æ + —Ç—É—à—ë–Ω–∞—è –∫–∞–ø—É—Å—Ç–∞. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–∏—Ä–æ–∂–∫–∏ –∏ –∑–∞–ø–µ—á—å/–æ–±–∂–∞—Ä–∏—Ç—å.", image: "" },
        { name: "–®–æ–∫–æ–ª–∞–¥–Ω—ã–π –º–∞—Ñ—Ñ–∏–Ω", recipe: "–ö–∞–∫–∞–æ + –º—É–∫–∞ + —è–π—Ü–∞ + –º–∞—Å–ª–æ. –í—ã–ø–µ–∫–∞—Ç—å 20 –º–∏–Ω—É—Ç.", image: "" }
      ],
      salads: [
        { name: "–¶–µ–∑–∞—Ä—å", recipe: "–ö—É—Ä–∏—Ü–∞, —Å–∞–ª–∞—Ç —Ä–æ–º–∞–Ω–æ, —Å—É—Ö–∞—Ä–∏–∫–∏, —Å–æ—É—Å —Ü–µ–∑–∞—Ä—å.", image: "" },
        { name: "–û–ª–∏–≤—å–µ", recipe: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å, –º–æ—Ä–∫–æ–≤—å, –æ–≥—É—Ä—Ü—ã, –∫–æ–ª–±–∞—Å–∞, —è–π—Ü–∞, –º–∞–π–æ–Ω–µ–∑.", image: "" },
        { name: "–ì—Ä–µ—á–µ—Å–∫–∏–π", recipe: "–û–≥—É—Ä—Ü—ã, –ø–æ–º–∏–¥–æ—Ä—ã, –º–∞—Å–ª–∏–Ω—ã, —Ñ–µ—Ç–∞, –æ–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ.", image: "" }
      ]
    };

    let menu;
    try {
      menu = JSON.parse(localStorage.getItem("menu"));
      if (!menu || typeof menu !== "object") {
        menu = defaultMenu;
        localStorage.setItem("menu", JSON.stringify(menu));
      }
    } catch (e) {
      menu = defaultMenu;
      localStorage.setItem("menu", JSON.stringify(menu));
    }

    let currentCategory = null;
    let currentIndex = null;
    let modalCategory = null;

    function renderMenu() {
      for (const category in menu) {
        const ul = document.getElementById(category);
        if (!ul) continue;
        ul.innerHTML = "";

        if (menu[category].length === 0) {
          ul.innerHTML = "<li style='text-align:center; color:#888;'>–ù–µ—Ç –±–ª—é–¥</li>";
        }

        menu[category].forEach((dish, index) => {
          const li = document.createElement("li");
          li.innerHTML = `
            <div class="dish-info" onclick="showRecipe('${category}', ${index})">
              ${dish.image ? `<img src="${dish.image}" alt="">` : ""}
              <span>${dish.name}</span>
            </div>
            <button class="delete-btn" onclick="deleteDish('${category}', ${index}, event)">‚ùå</button>
          `;
          ul.appendChild(li);
        });
      }
    }

    function addDish(categoryId) {
      modalCategory = categoryId;
      document.getElementById("dishModal").style.display = "flex";
    }

    function closeDishModal() {
      document.getElementById("dishModal").style.display = "none";
      document.getElementById("newDishName").value = "";
      modalCategory = null;
    }

    function saveNewDish() {
      const dishName = document.getElementById("newDishName").value.trim();
      if (!dishName) return;
      menu[modalCategory].push({ name: dishName, recipe: "", image: "" });
      saveMenu();
      renderMenu();
      closeDishModal();
    }

    function deleteDish(categoryId, index, event) {
      event.stopPropagation();
      menu[categoryId].splice(index, 1);
      saveMenu();
      renderMenu();
    }

    function showRecipe(category, index) {
      currentCategory = category;
      currentIndex = index;
      const dish = menu[category][index];

      document.getElementById("pageTitle").innerText = dish.name;
      document.getElementById("menuPage").style.display = "none";
      document.getElementById("recipePage").style.display = "block";
      document.getElementById("recipeTitle").innerText = dish.name;
      document.getElementById("recipeEditor").style.display = "none";
      document.getElementById("recipeText").style.display = "block";
      document.getElementById("editBtn").style.display = "inline-block";

      document.getElementById("recipeText").innerText =
        dish.recipe && dish.recipe.trim() !== "" ? dish.recipe : "–†–µ—Ü–µ–ø—Ç –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω.";

      const img = document.getElementById("recipeImage");
      if (dish.image) {
        img.src = dish.image;
        img.style.display = "block";
      } else {
        img.style.display = "none";
      }
    }

    function editRecipe() {
      if (currentCategory === null || currentIndex === null) return;
      const dish = menu[currentCategory][currentIndex];
      document.getElementById("recipeText").style.display = "none";
      document.getElementById("recipeEditor").style.display = "flex";
      document.getElementById("recipeInput").value = dish.recipe || "";
      document.getElementById("editBtn").style.display = "none";
    }

    function saveRecipe() {
      if (currentCategory === null || currentIndex === null) return;
      const newRecipe = document.getElementById("recipeInput").value;
      menu[currentCategory][currentIndex].recipe = newRecipe.trim();
      saveMenu();
      showRecipe(currentCategory, currentIndex);
    }

    function saveImage() {
      if (currentCategory === null || currentIndex === null) return;
      const fileInput = document.getElementById("imageInput");
      const file = fileInput.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        menu[currentCategory][currentIndex].image = e.target.result;
        saveMenu();
        showRecipe(currentCategory, currentIndex);
      };
      reader.readAsDataURL(file);
    }

    function showMenu() {
      document.getElementById("pageTitle").innerText = "–ú–µ–Ω—é";
      document.getElementById("menuPage").style.display = "grid";
      document.getElementById("recipePage").style.display = "none";
    }

    function saveMenu() {
      localStorage.setItem("menu", JSON.stringify(menu));
    }

    renderMenu();
  </script>
</body>
</html>
